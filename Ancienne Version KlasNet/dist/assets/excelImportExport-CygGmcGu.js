const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-DJfeul_Y.js","assets/index-CQL_eFg8.js","assets/index-DeG998tn.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{_ as k}from"./index-CQL_eFg8.js";async function X(l,t){return new Promise(async(i,r)=>{const s=new FileReader;s.onload=async o=>{try{const a=o.target.result,m=await k(()=>import("./xlsx-DGuHH-KN.js"),[]),S=m&&(m.default||m),p=new Uint8Array(a),I=S.read(p,{type:"array"}),N=I.SheetNames[0],R=I.Sheets[N],c=S.utils.sheet_to_json(R,{header:1});if(!c||c.length===0){r("Fichier Excel vide ou illisible");return}const n=c[0].map(e=>String(e||"").trim()),h=c.slice(1);if(!t){i({columns:n,preview:h.slice(0,5)});return}const E=t.matricule?n.findIndex(e=>e===t.matricule):-1,_=t.nom?n.findIndex(e=>e===t.nom):-1,w=t.prenoms?n.findIndex(e=>e===t.prenoms):-1,M=t.nomPrenoms?n.findIndex(e=>e===t.nomPrenoms):-1,v=t.paymentMontant?n.findIndex(e=>e===t.paymentMontant):-1,D=t.paymentDate?n.findIndex(e=>e===t.paymentDate):-1,A=t.paymentModalite?n.findIndex(e=>e===t.paymentModalite):-1;if(E===-1){r('Colonne "Matricule" non trouvée.');return}const g=h.map(e=>{let u="",f="";if(M!==-1){const d=String(e[M]||"").trim().split(" ");u=d[0]||"",f=d.slice(1).join(" ")}else u=_!==-1?String(e[_]||"").trim():"",f=w!==-1?String(e[w]||"").trim():"";const P={id:"",matricule:String(e[E]||"").trim(),nom:u,prenoms:f,sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:"",anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:"",adresse:"",photo:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},x=[];if(v!==-1){const y=String(e[v]??"").trim();if(y!==""){const d=Number(y.replace(/[^0-9.-]+/g,""))||0,O=D!==-1?String(e[D]??"").trim():new Date().toISOString(),b=A!==-1?String(e[A]??"").trim():"",L=b?Number(b):void 0;x.push({montant:d,date:O,modalite:L})}}return x.length&&(P.payments=x),P});i(g)}catch(a){r(a instanceof Error?a.message:String(a))}},s.onerror=()=>r("Erreur lecture du fichier"),s.readAsArrayBuffer(l)})}async function B(l){const t=await k(()=>import("./exceljs.min-DJfeul_Y.js").then(o=>o.e),__vite__mapDeps([0,1,2,3])),i=t&&(t.default||t),r=new i.Workbook,s=r.addWorksheet("Élèves");return s.addRow(["Matricule","Nom && Prénoms","Moyenne"]),l.forEach(o=>{s.addRow([o.matricule,`${o.nom} ${o.prenoms}`,""])}),await r.xlsx.writeBuffer()}export{B as exporterElevesEnExcel,X as importerElevesDepuisExcel};
